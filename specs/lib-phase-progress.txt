completed: phase 1
completed: phase 2
completed: phase 3 (partial - libraries build, linking has symbol conflicts)
completed: phase 4 (symbol conflicts fixed, libraries fully functional)

Phase 2 Summary (2026-01-20):
- All 6 tests PASS with vbcc/vasm toolchain
- Test 2.1: Help target works
- Test 2.2: Clean target works
- Test 2.3: Full build succeeds (30 C files + 23 ASM files)
- Test 2.4: db.lib created
- Test 2.5: startup.lib created
- Test 2.6: Object files created

Issues fixed during Phase 2:
1. ilbm_lib.h header case mismatch - renamed ILBM_Lib.h to ilbm_lib.h
2. Toolchain path - use /vbcc/bin/ prefix for vbcc tools
3. Type errors in ser.c and window.c - cast pointers to ULONG for return values

Phase 3 Summary (2026-01-20):
- Compilation: PASS (ACE -> vasm -> object file)
- Linking: FAIL (symbol conflicts in libraries)

Link errors discovered:
1. Duplicate symbol _turncursoron in startup.lib and db.lib(scrwin.s)
2. Duplicate symbol _Wdw_list in window.c and scrwin_data.s
3. Undefined symbol _MathIeeeDoubTransBase (IEEE math library)

These are pre-existing issues in the library source code that vlink
catches but the original blink linker was more lenient about.

Toolchain Evolution:
- Original plan: gcc + a68k (failed - format mismatch a.out vs hunk)
- Final solution: vbcc + vasm (produces proper Amiga hunk format)

Conclusion:
Makefile-lib successfully builds libraries with vbcc/vasm toolchain.
The libraries have symbol conflicts that need source-level fixes to
fully work with vlink. This is a library architecture issue, not a
Makefile issue.

Phase 4 Summary (2026-01-20):
Symbol conflict fixes applied:

1. _turncursoron duplicate - FIXED
   - Root cause: scrwin.s defined _turncursoron at line 378, identical to startup.s:541
   - scrwin.s also had xref _turncursoron (line 201), which was inconsistent
   - Fix: Removed duplicate definition from src/lib/asm/scrwin.s
   - Now uses external definition from startup.s via xref

2. _Wdw_list duplicate - FIXED
   - Root cause: Two separate window tracking systems:
     - window.c: 17 entries of WDW struct (Window*, RastPort*, fgdpen, bgpen)
     - scrwin_data.s: 10 longs (simple window pointers)
   - These are architecturally different but have the same symbol name
   - Fix: Made window.c's Wdw_list static (file-local scope)
   - Assembly code continues to use scrwin_data.s definition

3. _MathIeeeDoubTransBase undefined - NOT OUR ISSUE
   - This symbol is NOT in db.lib or startup.lib
   - It's defined in src/dp/dp_main.s (double-precision module)
   - The dp module is not part of the Makefile-lib build
   - The undefined reference comes from ami.lib (external library)
   - This is outside the scope of the library build

Files modified:
- src/lib/asm/scrwin.s - Removed _turncursoron definition
- src/lib/c/window.c - Made Wdw_list static
- src/lib/startup/startup.s - Added MathIeeeDoubTransBase support

Phase 4 Verification Results (2026-01-20):
------------------------------------------
After fixing all symbol conflicts, Phase 3 re-run:

- Test 3.1: Compile and Link - PASS
  - Preprocessing: OK
  - Compilation: OK
  - Assembly: OK
  - Linking: OK (no more undefined symbol errors)
  - Executable created: 24760 bytes

- Test 3.2: Execute Program - PASS
  - Program ran without errors
  - Exit code: 0

- Test 3.3: Verify Output - PASS
  - Expected: "Hello from ACE!"
  - Actual: Contains "Hello from ACE!" (with cursor control sequences)

CONCLUSION: Makefile-lib and runtime libraries are fully functional.
The vbcc/vasm/vlink toolchain successfully builds and links ACE programs.
